# Image Verification Flow - –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑

## –ü—Ä–æ–±–ª–µ–º–∞: Canon EOS 5D Mark III —Å Lightroom –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ 95% AI

### EXIF —Ñ–æ—Ç–æ:
- Make: **Canon**
- Model: **Canon EOS 5D Mark III**
- **SerialNumber: 182029011977** ‚Üê SMOKING GUN
- **LensSerialNumber: 00000409ab** ‚Üê SMOKING GUN
- LensModel: EF85mm f/1.8 USM
- Software: **Adobe Photoshop CS6 (Macintosh)**
- **CreatorTool (XMP): Adobe Photoshop Lightroom 5.3** ‚Üê –ù–ï –ü–†–û–í–ï–†–Ø–ï–¢–°–Ø!
- DateTimeOriginal: 2016:02:03 19:08:51
- DateTime: 2019:10:21 20:42:02

---

## –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### 1Ô∏è‚É£ TELEGRAM BOT FLOW (preserve_exif=False)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. –ë–û–¢ (truthsnap-bot/app/bot/handlers/photo.py)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ image_bytes + preserve_exif=False
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. API ENDPOINT: /api/v1/verify                                ‚îÇ
‚îÇ    (fraudlens/backend/api/routes/consumer.py:302)             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ telegram_mode = True (because preserve_exif=False)
         ‚îÇ source_platform = None
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–´–ï –î–ï–¢–ï–ö–¢–û–†–´ (7 —à—Ç—É–∫)                             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚ë† fraud_detector.detect_ai_generation(image_bytes)             ‚îÇ
‚îÇ    ‚Üí AI heuristic score (0-1)                                   ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ ‚ë° watermark_detector.detect(image_bytes)                       ‚îÇ
‚îÇ    ‚Üí C2PA watermark detection                                   ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ ‚ë¢ visual_watermark_detector.detect_watermark(temp_path)        ‚îÇ
‚îÇ    ‚Üí OCR-based watermark detection                              ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ ‚ë£ metadata_analyzer.analyze(image_bytes)                       ‚îÇ
‚îÇ    ‚Üí EXIF extraction (GPS, Device, Software)                    ‚îÇ
‚îÇ    ‚úÖ USES: image.getexif() (MODERN)                           ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ ‚ë§ metadata_validator.validate(image_bytes)                     ‚îÇ
‚îÇ    ‚Üí EXIF fraud detection (10 layers)                           ‚îÇ
‚îÇ    ‚ùå USES: image._getexif() (DEPRECATED!)                     ‚îÇ
‚îÇ    ‚ùå NOT CHECKING: CreatorTool, SerialNumber                   ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ ‚ë• fft_detector.analyze(image_bytes)                            ‚îÇ
‚îÇ    ‚Üí Frequency domain analysis                                  ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ ‚ë¶ face_swap_detector.analyze(image_bytes)                      ‚îÇ
‚îÇ    ‚Üí Deepfake detection                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ Results aggregated
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 4. VERDICT DETERMINATION                                        ‚îÇ
‚îÇ    (consumer.py:629 - determine_consumer_verdict())            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Input:                                                           ‚îÇ
‚îÇ  - detection (AI score)                                          ‚îÇ
‚îÇ  - watermark                                                     ‚îÇ
‚îÇ  - metadata                                                      ‚îÇ
‚îÇ  - validation (fraud_score from validator)                      ‚îÇ
‚îÇ  - fft_score                                                     ‚îÇ
‚îÇ  - face_swap_score                                               ‚îÇ
‚îÇ  - visual_watermark                                              ‚îÇ
‚îÇ  - source_platform (None for bot)                               ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ SMOKING GUNS (priority):                                        ‚îÇ
‚îÇ  1. Visual watermark (AI generator) ‚Üí ai_generated (98%)        ‚îÇ
‚îÇ  2. C2PA watermark ‚Üí ai_generated (95%)                         ‚îÇ
‚îÇ  3. AI software in EXIF ‚Üí ai_generated (98%)                    ‚îÇ
‚îÇ  4. Screenshot detected ‚Üí manipulated (95%)                     ‚îÇ
‚îÇ  5. High fraud score (>=80) ‚Üí ai_generated/manipulated          ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ WEIGHTED SCORING:                                               ‚îÇ
‚îÇ  score = (ai_heuristic √ó 0.35) +                               ‚îÇ
‚îÇ          (fft_score √ó 0.30) +                                   ‚îÇ
‚îÇ          (metadata_risk √ó 0.25) +                               ‚îÇ
‚îÇ          (face_swap √ó 0.10)                                     ‚îÇ
‚îÇ          - social_media_reduction                               ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ SPECIAL CASES:                                                  ‚îÇ
‚îÇ  - Trusted software (Lightroom) ‚Üí reduce metadata_risk by 0.30 ‚îÇ
‚îÇ    ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ red_flags!                  ‚îÇ
‚îÇ  - Stock photo ‚Üí reduce AI heuristic                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### 2Ô∏è‚É£ LINKEDIN/FACEBOOK FLOW (source=linkedin)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. BROWSER EXTENSION / API CALL                                ‚îÇ
‚îÇ    source="linkedin" or "instagram" or "facebook"              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. API ENDPOINT: /api/v1/analyze or /api/v1/verify            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ telegram_mode = True (source is not None)
         ‚îÇ source_platform = "linkedin"
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–´–ï –î–ï–¢–ï–ö–¢–û–†–´ (9 —à—Ç—É–∫ –¥–ª—è social media)           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Same as above (7 detectors) +                                   ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ ‚ëß prnu_detector.detect(temp_path)                              ‚îÇ
‚îÇ    ‚Üí PRNU sensor noise detection                                ‚îÇ
‚îÇ    ‚úÖ SURVIVES LinkedIn/Instagram compression                   ‚îÇ
‚îÇ    ‚Üí has_prnu, prnu_strength, fraud_score                       ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ ‚ë® intrinsic_detector.detect(temp_path)                         ‚îÇ
‚îÇ    ‚Üí Intrinsic camera fingerprints                              ‚îÇ
‚îÇ    ‚Üí total_score, detection_methods, confidence                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 4. SOCIAL MEDIA NORMALIZATION (consumer.py:761-878)           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ PRNU-BASED DECISION:                                            ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ Case 1: PNG + FFT>0.65 + PRNU detected                         ‚îÇ
‚îÇ  ‚Üí AI with SYNTHETIC NOISE                                      ‚îÇ
‚îÇ  ‚Üí metadata_risk += 0.25 (BOOST)                               ‚îÇ
‚îÇ  ‚Üí Real cameras shoot JPEG, not PNG                             ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ Case 2: JPEG + Strong PRNU + Low fraud score                   ‚îÇ
‚îÇ  ‚Üí Check intrinsic detector                                     ‚îÇ
‚îÇ  ‚Üí If high FFT (>0.75) ‚Üí AI (social media converted PNG‚ÜíJPEG)  ‚îÇ
‚îÇ  ‚Üí If low FFT ‚Üí REAL PHOTO (aggressive normalization)          ‚îÇ
‚îÇ     - fft_score √ó 0.4 (reduce by 60%)                          ‚îÇ
‚îÇ     - ai_heuristic √ó 0.6 (reduce by 40%)                       ‚îÇ
‚îÇ     - social_media_reduction = 0.20                             ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ Case 3: No PRNU or weak PRNU                                   ‚îÇ
‚îÇ  ‚Üí Likely AI                                                    ‚îÇ
‚îÇ  ‚Üí No normalization                                             ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ Case 4: Medium PRNU + high fraud score                         ‚îÇ
‚îÇ  ‚Üí MANIPULATED (splice/edit detected)                          ‚îÇ
‚îÇ  ‚Üí Minimal normalization                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üö® –ü–†–û–ë–õ–ï–ú–´ –í –¢–ï–ö–£–©–ï–ô –°–ò–°–¢–ï–ú–ï

### –ü—Ä–æ–±–ª–µ–º–∞ #1: metadata_validator –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DEPRECATED –º–µ—Ç–æ–¥

**–§–∞–π–ª**: `fraudlens/backend/integrations/metadata_validator.py:222`

```python
# ‚ùå DEPRECATED METHOD:
exif = image._getexif()

# ‚úÖ –î–û–õ–ñ–ù–û –ë–´–¢–¨:
exif = image.getexif()
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –¢–µ—Ä—è—é—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ EXIF –ø–æ–ª—è
- GPS –º–æ–∂–µ—Ç –Ω–µ –∏–∑–≤–ª–µ—á—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Pillow 10+

---

### –ü—Ä–æ–±–ª–µ–º–∞ #2: CreatorTool (XMP) –ù–ï –ü–†–û–í–ï–†–Ø–ï–¢–°–Ø

**–¢–µ–∫—É—â–∏–π –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
```python
software = exif_data.get("Software", "").lower()
# Software: "Adobe Photoshop CS6 (Macintosh)"
# ‚Üí –ù–∞—Ö–æ–¥–∏—Ç "photoshop" ‚Üí penalty_reduction = 30
```

**–ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
```python
creator_tool = xmp_data.get("CreatorTool", "").lower()
# CreatorTool: "Adobe Photoshop Lightroom 5.3 (Macintosh)"
# ‚Üí –î–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å "lightroom" ‚Üí penalty_reduction = 50
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- Score = 85 - 30 = **55** (medium risk) ‚ùå
- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: 85 - 50 = **35** (low risk) ‚úÖ

---

### –ü—Ä–æ–±–ª–µ–º–∞ #3: Serial Numbers –ù–ï –ü–†–û–í–ï–†–Ø–Æ–¢–°–Ø

**–ï—Å—Ç—å –≤ EXIF:**
- `SerialNumber: 182029011977` ‚Üê Camera body serial
- `LensSerialNumber: 00000409ab` ‚Üê Lens serial

**–ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∏–≥–¥–µ –≤ –∫–æ–¥–µ!**

**–≠—Ç–æ SMOKING GUN –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ñ–æ—Ç–æ:**
- AI –Ω–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –≤–∞–ª–∏–¥–Ω—ã–µ serial numbers
- Serial numbers —É–Ω–∏–∫–∞–ª—å–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞–º–µ—Ä—ã/–æ–±—ä–µ–∫—Ç–∏–≤–∞
- –ù–∞–ª–∏—á–∏–µ serial = -30 –∫ fraud score (–ë–û–ù–£–°)

---

### –ü—Ä–æ–±–ª–µ–º–∞ #4: exiftool –¥–∞–Ω–Ω—ã–µ –ù–ï –û–ë–™–ï–î–ò–ù–Ø–Æ–¢–°–Ø

**TruthSnapBot:**
```python
exif_data = self._extract_exif(image)        # deprecated _getexif()
exiftool_data = self._extract_exiftool(bytes) # exiftool

# ‚ùå –ù–ï –û–ë–™–ï–î–ò–ù–Ø–Æ–¢–°–Ø! –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–¥–µ–ª—å–Ω–æ
apple_check = self._check_apple_runtime(exif_data, exiftool_data)
software_check = self._check_software_manipulation(exif_data)  # ‚Üê –¢–æ–ª—å–∫–æ exif_data!
```

**FraudLensAI (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```python
exif_data = self._extract_complete_exif(image_path)    # piexif
exiftool_data = self._extract_exiftool(image_path)     # exiftool

# ‚úÖ –û–ë–™–ï–î–ò–ù–Ø–Æ–¢–°–Ø:
exif_data.update(exiftool_data)  # exiftool has priority

# –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ #5: Trusted software –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û

**–¢–µ–∫—É—â–∏–π –∫–æ–¥** (consumer.py:739-748):
```python
# SPECIAL CASE: Trusted software detected (Lightroom, Capture One)
trusted_software_detected = False
for flag in red_flags:  # ‚Üê –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ RED FLAGS!
    if flag.get("trust_level") in ["high", "medium"]:
        trusted_software_detected = True
        metadata_risk = max(0, metadata_risk - 0.30)
        break
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- Lightroom –ù–ï —è–≤–ª—è–µ—Ç—Å—è red flag!
- Lightroom - —ç—Ç–æ –ü–û–ó–ò–¢–ò–í–ù–´–ô —Å–∏–≥–Ω–∞–ª
- –ù–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω –ø–æ–ø–∞–ª –≤ red_flags
- –î–ª—è —ç—Ç–æ–≥–æ —Ñ–æ—Ç–æ Lightroom –Ω–µ –≤ red_flags (–æ–Ω –≤ CreatorTool)

**–†–ï–®–ï–ù–ò–ï:**
```python
# –ü—Ä–æ–≤–µ—Ä—è—Ç—å –î–û –≤—ã—á–∏—Å–ª–µ–Ω–∏—è red_flags:
software = metadata.get("raw_exif", {}).get("Software", "").lower()
creator_tool = metadata.get("raw_exif", {}).get("CreatorTool", "").lower()

TRUSTED_SOFTWARE = {
    "lightroom": {"trust_level": "high", "bonus": -30},
    "capture one": {"trust_level": "high", "bonus": -30},
    "photoshop": {"trust_level": "medium", "bonus": -15},
}

for name, info in TRUSTED_SOFTWARE.items():
    if name in software or name in creator_tool:
        metadata_risk += info["bonus"] / 100.0  # Negative = bonus
        break
```

---

## üìä –ß–¢–û –ü–†–û–ò–°–•–û–î–ò–¢ –° CANON –§–û–¢–û

### –¢–µ–∫—É—â–∏–π —Ñ–ª–æ—É –¥–ª—è Canon EOS 5D Mark III:

```
1. metadata_analyzer.analyze(bytes)
   ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç getexif()
   ‚úÖ –ò–∑–≤–ª–µ–∫–∞–µ—Ç: Make, Model, Software
   ‚ö†Ô∏è  SerialNumber –ù–ï –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ raw_exif

2. metadata_validator.validate(bytes)
   ‚ùå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç _getexif() (deprecated)
   ‚ùå –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç CreatorTool (XMP)
   ‚ùå –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç SerialNumber

   Software check:
   - Software: "Adobe Photoshop CS6"
   - Finds "photoshop" ‚Üí score = 85 - 30 = 55
   - CreatorTool: "Lightroom" ‚Üí NOT CHECKED

   Result: fraud_score = 55 (medium risk)

3. determine_consumer_verdict()
   - metadata_risk = 55 / 100.0 = 0.55

   Trusted software check:
   - –ò—â–µ—Ç –≤ red_flags with trust_level
   - Photoshop –µ—Å—Ç—å, –Ω–æ trust_level = "medium"
   - Reduction: 0.30
   - metadata_risk = 0.55 - 0.30 = 0.25

   Weighted score:
   - ai_heuristic √ó 0.35 = 0.XX
   - fft_score √ó 0.30 = 0.XX
   - metadata_risk √ó 0.25 = 0.0625
   - face_swap √ó 0.10 = 0.XX

   Combined score = 0.XX (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç AI/FFT –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤)

   ‚ö†Ô∏è –ï—Å–ª–∏ AI detector –¥–∞—ë—Ç –≤—ã—Å–æ–∫–∏–π score ‚Üí verdict = "ai_generated"
   ‚ö†Ô∏è –ï—Å–ª–∏ FFT detector –¥–∞—ë—Ç –≤—ã—Å–æ–∫–∏–π score ‚Üí verdict = "ai_generated"
```

---

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### Fix #1: –û–±–Ω–æ–≤–∏—Ç—å _extract_exif() –≤ metadata_validator.py

```python
def _extract_exif(self, image: Image.Image) -> Dict:
    """Extract EXIF data from image"""
    exif_data = {}

    try:
        # ‚úÖ MODERN METHOD:
        exif = image.getexif()
        if exif:
            for tag_id, value in exif.items():
                tag = TAGS.get(tag_id, tag_id)
                try:
                    exif_data[tag] = str(value)
                except:
                    pass
    except:
        pass

    return exif_data
```

### Fix #2: –ü—Ä–æ–≤–µ—Ä—è—Ç—å CreatorTool –≤ _check_software_manipulation()

```python
def _check_software_manipulation(self, exif_data: Dict, exiftool_data: Dict) -> Dict:
    """Check both Software field (EXIF) and CreatorTool (XMP)"""

    software = exif_data.get("Software", "").lower()
    creator_tool = exiftool_data.get("XMP:CreatorTool", "").lower()

    # Check BOTH fields
    combined = software + " " + creator_tool

    # Check for Lightroom first (higher priority)
    for trusted_name, trust_info in self.TRUSTED_PHOTO_SOFTWARE.items():
        if trusted_name in combined:
            # Return highest trust level found
            ...
```

### Fix #3: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É Serial Numbers

```python
def _check_camera_authenticity(self, exif_data: Dict, exiftool_data: Dict) -> Dict:
    """
    Layer 0: Camera Authenticity Check

    Serial numbers = SMOKING GUN for real photos
    AI cannot create valid camera/lens serials

    Returns negative score = BONUS for authentic cameras
    """
    camera_serial = exiftool_data.get("EXIF:SerialNumber") or \
                   exiftool_data.get("MakerNotes:SerialNumber")
    lens_serial = exiftool_data.get("EXIF:LensSerialNumber") or \
                 exiftool_data.get("MakerNotes:LensSerialNumber")

    if camera_serial and lens_serial:
        # Both serials present = highly authentic
        return {
            "layer": "Camera Authenticity",
            "status": "PASS",
            "score": -30,  # BONUS (negative score)
            "reason": f"Camera + Lens serials detected (Camera: {camera_serial})",
            "description": "Serial numbers = smoking gun for real camera"
        }
    elif camera_serial or lens_serial:
        # One serial = still good
        return {
            "layer": "Camera Authenticity",
            "status": "PASS",
            "score": -20,
            "reason": "Camera serial detected",
            "description": "Serial number indicates real camera"
        }

    return {"layer": "Camera Authenticity", "status": "N/A", "score": 0}
```

### Fix #4: –û–±—ä–µ–¥–∏–Ω–∏—Ç—å exif_data –∏ exiftool_data

```python
# –í validate():
exif_data = self._extract_exif(image)
exiftool_data = self._extract_exiftool(image_bytes)

# ‚úÖ MERGE DATA:
if exiftool_data:
    exif_data.update(exiftool_data)  # exiftool has priority

# Now all checks use combined data
```

---

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢ –ü–û–°–õ–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –î–ª—è Canon EOS 5D Mark III + Lightroom + Photoshop:

```
1. Camera Authenticity Check:
   ‚úÖ SerialNumber: 182029011977
   ‚úÖ LensSerialNumber: 00000409ab
   ‚Üí score = -30 (BONUS)

2. Software Check:
   ‚úÖ CreatorTool: "Lightroom 5.3"
   ‚úÖ Software: "Photoshop CS6"
   ‚Üí Lightroom found first ‚Üí penalty_reduction = 50
   ‚Üí score = 85 - 50 = 35

3. Total metadata fraud_score:
   - Base: 0
   - Camera authenticity: -30
   - Software editing: +35
   - GPS missing: +0 (telegram_mode –∏–ª–∏ –¥–æ–ø—É—Å—Ç–∏–º–æ –¥–ª—è —Å—Ç—É–¥–∏–π–Ω—ã—Ö —Ñ–æ—Ç–æ)
   ‚Üí Total = 5-10 (LOW RISK)

4. Verdict:
   - metadata_risk = 0.05-0.10
   - Combined score = LOW
   ‚Üí verdict = "real" with high confidence ‚úÖ
```

---

## üîç –°–†–ê–í–ù–ï–ù–ò–ï: –î–û vs –ü–û–°–õ–ï

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–û | –ü–û–°–õ–ï |
|----------|-----|--------|
| EXIF extraction | _getexif() ‚ùå | getexif() ‚úÖ |
| CreatorTool check | NOT checked ‚ùå | Checked ‚úÖ |
| Serial Numbers | NOT checked ‚ùå | Checked ‚úÖ |
| Data merge | Separate ‚ùå | Merged ‚úÖ |
| Canon fraud_score | ~55 (medium) ‚ùå | ~5-10 (low) ‚úÖ |
| Final verdict | AI 95% ‚ùå | Real 90%+ ‚úÖ |

---

## üìù –ü–†–ò–û–†–ò–¢–ï–¢–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### üî¥ CRITICAL (—Å–µ–π—á–∞—Å):
1. Fix #1: –û–±–Ω–æ–≤–∏—Ç—å _extract_exif() ‚Üí getexif()
2. Fix #4: –û–±—ä–µ–¥–∏–Ω–∏—Ç—å exif_data + exiftool_data

### üü° HIGH (—Å–∫–æ—Ä–æ):
3. Fix #2: –ü—Ä–æ–≤–µ—Ä—è—Ç—å CreatorTool
4. Fix #3: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É Serial Numbers

### üü¢ MEDIUM (–ø–æ—Ç–æ–º):
5. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ trusted software logic
6. –î–æ–±–∞–≤–∏—Ç—å device profile validation

---

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞**: 2026-02-12
**–í–µ—Ä—Å–∏—è**: TruthSnapBot commit 2891b01
